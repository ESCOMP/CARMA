<HTML>
<HEAD>
   <TITLE> subroutine coremasscheck (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine coremasscheck </H1>
<PRE>subroutine coremasscheck

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(inout) :: <A HREF="coremasscheck.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="coremasscheck.html#var_cstate">cstate</A>
    integer, intent(in) :: <A HREF="coremasscheck.html#var_iz">iz</A>
    logical, intent(in) :: <A HREF="coremasscheck.html#var_fixcoremass">fixcoremass</A>
    logical, intent(in) :: <A HREF="coremasscheck.html#var_logmsg">logmsg</A>
    logical, intent(in) :: <A HREF="coremasscheck.html#var_abort">abort</A>
    character (len=*), intent(in) :: <A HREF="coremasscheck.html#var_packagename">packagename</A>
    integer, intent(inout) :: <A HREF="coremasscheck.html#var_rc">rc</A>
    integer :: <A HREF="coremasscheck.html#var_igroup">igroup</A>
    integer :: <A HREF="coremasscheck.html#var_ibin">ibin</A>
    integer :: <A HREF="coremasscheck.html#var_iepart">iepart</A>
    integer :: <A HREF="coremasscheck.html#var_i">i</A>
    integer :: <A HREF="coremasscheck.html#var_icore">icore</A>
    real (kind=f) :: <A HREF="coremasscheck.html#var_coremass">coremass</A>
    real (kind=f) :: <A HREF="coremasscheck.html#var_factor">factor</A>
    real (kind=f), parameter :: <A HREF="coremasscheck.html#var_roundoff">roundoff</A> = 1.e-14_f

end subroutine coremasscheck
</PRE>
  This routine checks if the coremass exceeds the total.
<P>
 NOTE: The fixer in this case is not mass conserving, and thus can have
 the effect of creating mass of the concentration element (by removing
 the negative values).
<P>
 NOTE: Errors will only be logged and runs aborted if they are greater
 than roundoff error.
<P>
<STRONG>Author:</STRONG> Yunqian Zhu, Charles Bardeen
<P>
<STRONG>Version:</STRONG> Apr-2021

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(inout) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_iz"><H3>iz</H3></A>
<PRE>integer, intent(in) :: iz
</PRE>
<A NAME="var_fixcoremass"><H3>fixcoremass</H3></A>
<PRE>logical, intent(in) :: fixcoremass
</PRE>
 if we fix the coremass if exceeds total
<A NAME="var_logmsg"><H3>logmsg</H3></A>
<PRE>logical, intent(in) :: logmsg
</PRE>
 write message to log file if core mass check fails
<A NAME="var_abort"><H3>abort</H3></A>
<PRE>logical, intent(in) :: abort
</PRE>
 set return code to ERROR and return if  if core mass check fails
<A NAME="var_packagename"><H3>packagename</H3></A>
<PRE>character (len=*), intent(in) :: packagename
</PRE>
 string to add to error message
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative
<A NAME="var_igroup"><H3>igroup</H3></A>
<PRE>integer :: igroup
</PRE>
<A NAME="var_ibin"><H3>ibin</H3></A>
<PRE>integer :: ibin
</PRE>
<A NAME="var_iepart"><H3>iepart</H3></A>
<PRE>integer :: iepart
</PRE>
<A NAME="var_i"><H3>i</H3></A>
<PRE>integer :: i
</PRE>
<A NAME="var_icore"><H3>icore</H3></A>
<PRE>integer :: icore
</PRE>
<A NAME="var_coremass"><H3>coremass</H3></A>
<PRE>real (kind=f) :: coremass
</PRE>
<A NAME="var_factor"><H3>factor</H3></A>
<PRE>real (kind=f) :: factor
</PRE>
<A NAME="var_roundoff"><H3>roundoff</H3></A>
<PRE>real (kind=f), parameter :: roundoff = 1.e-14_f
</PRE>
</HTML>
