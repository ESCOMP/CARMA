<HTML>
<HEAD>
   <TITLE> subroutine versol (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine versol </H1>
<PRE>subroutine versol

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="versol.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="versol.html#var_cstate">cstate</A>
    real (kind=f), intent(inout), dimension (NZ) :: <A HREF="versol.html#var_cvert">cvert</A>
    integer, intent(in) :: <A HREF="versol.html#var_itbnd">itbnd</A>
    integer, intent(in) :: <A HREF="versol.html#var_ibbnd">ibbnd</A>
    real (kind=f), intent(in) :: <A HREF="versol.html#var_ftop">ftop</A>
    real (kind=f), intent(in) :: <A HREF="versol.html#var_fbot">fbot</A>
    real (kind=f), intent(in) :: <A HREF="versol.html#var_cvert_tbnd">cvert_tbnd</A>
    real (kind=f), intent(in) :: <A HREF="versol.html#var_cvert_bbnd">cvert_bbnd</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versol.html#var_vertadvu">vertadvu</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versol.html#var_vertadvd">vertadvd</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versol.html#var_vertdifu">vertdifu</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versol.html#var_vertdifd">vertdifd</A>
    integer, intent(inout) :: <A HREF="versol.html#var_rc">rc</A>
    integer :: <A HREF="versol.html#var_k">k</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_al">al</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_bl">bl</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_dl">dl</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_el">el</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_fl">fl</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_ul">ul</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_ctempl">ctempl</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_ctempu">ctempu</A>
    real (kind=f), dimension (NZ) :: <A HREF="versol.html#var_divcor">divcor</A>
    real (kind=f) :: <A HREF="versol.html#var_uc">uc</A>
    real (kind=f) :: <A HREF="versol.html#var_cour">cour</A>
    real (kind=f) :: <A HREF="versol.html#var_denom">denom</A>

end subroutine versol
</PRE>
  This routine solves the vertical transport equation.
  <cvert> is temporary storage for concentrations (particles,
  gas, potential temperature) being transported.
  New values of <cvert> are calculated.
<P>
<STRONG>Author:</STRONG> Eric Jensen
<P>
<STRONG>Version:</STRONG> Dec-1996

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_cvert"><H3>cvert</H3></A>
<PRE>real (kind=f), intent(inout), dimension (NZ) :: cvert
</PRE>
 quantity being transported
<A NAME="var_itbnd"><H3>itbnd</H3></A>
<PRE>integer, intent(in) :: itbnd
</PRE>
 top boundary condition
<A NAME="var_ibbnd"><H3>ibbnd</H3></A>
<PRE>integer, intent(in) :: ibbnd
</PRE>
 bottom boundary condition
<A NAME="var_ftop"><H3>ftop</H3></A>
<PRE>real (kind=f), intent(in) :: ftop
</PRE>
 flux at top boundary
<A NAME="var_fbot"><H3>fbot</H3></A>
<PRE>real (kind=f), intent(in) :: fbot
</PRE>
 flux at bottom boundary
<A NAME="var_cvert_tbnd"><H3>cvert_tbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_tbnd
</PRE>
 quantity at top boundary
<A NAME="var_cvert_bbnd"><H3>cvert_bbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_bbnd
</PRE>
 quantity at bottom boundary
<A NAME="var_vertadvu"><H3>vertadvu</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertadvu
</PRE>
 upward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_vertadvd"><H3>vertadvd</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertadvd
</PRE>
 downward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_vertdifu"><H3>vertdifu</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertdifu
</PRE>
 upward vertical diffusion rate into level k from level k-1 [cm/s]
<A NAME="var_vertdifd"><H3>vertdifd</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertdifd
</PRE>
 downward vertical diffusion rate into level k from level k-1 [cm/s]
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_k"><H3>k</H3></A>
<PRE>integer :: k
</PRE>
<A NAME="var_al"><H3>al</H3></A>
<PRE>real (kind=f), dimension (NZ) :: al
</PRE>
<A NAME="var_bl"><H3>bl</H3></A>
<PRE>real (kind=f), dimension (NZ) :: bl
</PRE>
<A NAME="var_dl"><H3>dl</H3></A>
<PRE>real (kind=f), dimension (NZ) :: dl
</PRE>
<A NAME="var_el"><H3>el</H3></A>
<PRE>real (kind=f), dimension (NZ) :: el
</PRE>
<A NAME="var_fl"><H3>fl</H3></A>
<PRE>real (kind=f), dimension (NZ) :: fl
</PRE>
<A NAME="var_ul"><H3>ul</H3></A>
<PRE>real (kind=f), dimension (NZ) :: ul
</PRE>
<A NAME="var_ctempl"><H3>ctempl</H3></A>
<PRE>real (kind=f), dimension (NZ) :: ctempl
</PRE>
<A NAME="var_ctempu"><H3>ctempu</H3></A>
<PRE>real (kind=f), dimension (NZ) :: ctempu
</PRE>
<A NAME="var_divcor"><H3>divcor</H3></A>
<PRE>real (kind=f), dimension (NZ) :: divcor
</PRE>
<A NAME="var_uc"><H3>uc</H3></A>
<PRE>real (kind=f) :: uc
</PRE>
<A NAME="var_cour"><H3>cour</H3></A>
<PRE>real (kind=f) :: cour
</PRE>
<A NAME="var_denom"><H3>denom</H3></A>
<PRE>real (kind=f) :: denom
</PRE>
</HTML>
