<HTML>
<HEAD>
   <TITLE> subroutine test_growin_sub (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine test_growin_sub </H1>
<PRE>subroutine test_growin_sub

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmaelement_mod.html">carmaelement_mod</A>
    use <A HREF="carmagroup_mod.html">carmagroup_mod</A>
    use <A HREF="carmagas_mod.html">carmagas_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>
    use <A HREF="atmosphere_mod.html">atmosphere_mod</A>

        ! Calls
    call <A HREF="CARMAELEMENT_Create.html">CARMAELEMENT_Create</A>
    call <A HREF="CARMAGAS_Create.html">CARMAGAS_Create</A>
    call <A HREF="CARMAGROUP_Create.html">CARMAGROUP_Create</A>
    call <A HREF="CARMAGROUP_Get.html">CARMAGROUP_Get</A>
    call <A HREF="CARMASTATE_Create.html">CARMASTATE_Create</A>
    call <A HREF="CARMASTATE_Destroy.html">CARMASTATE_Destroy</A>
    call <A HREF="CARMASTATE_Get.html">CARMASTATE_Get</A>
    call <A HREF="CARMASTATE_GetBin.html">CARMASTATE_GetBin</A>
    call <A HREF="CARMASTATE_GetGas.html">CARMASTATE_GetGas</A>
    call <A HREF="CARMASTATE_GetState.html">CARMASTATE_GetState</A>
    call <A HREF="CARMASTATE_SetBin.html">CARMASTATE_SetBin</A>
    call <A HREF="CARMASTATE_SetGas.html">CARMASTATE_SetGas</A>
    call <A HREF="CARMASTATE_Step.html">CARMASTATE_Step</A>
    call <A HREF="CARMA_AddGrowth.html">CARMA_AddGrowth</A>
    call <A HREF="CARMA_Create.html">CARMA_Create</A>
    call <A HREF="CARMA_Destroy.html">CARMA_Destroy</A>
    call <A HREF="CARMA_Initialize.html">CARMA_Initialize</A>
    call <A HREF="GetStandardAtmosphere.html">GetStandardAtmosphere</A>

        ! Variables
    integer, parameter :: <A HREF="test_growin_sub.html#var_nz">NZ</A> = 1
    integer, parameter :: <A HREF="test_growin_sub.html#var_nzp1">NZP1</A> = NZ + 1
    integer, parameter :: <A HREF="test_growin_sub.html#var_nelem">NELEM</A> = 1
    integer, parameter :: <A HREF="test_growin_sub.html#var_nbin">NBIN</A> = 18
    integer, parameter :: <A HREF="test_growin_sub.html#var_ngroup">NGROUP</A> = 1
    integer, parameter :: <A HREF="test_growin_sub.html#var_nsolute">NSOLUTE</A> = 0
    integer, parameter :: <A HREF="test_growin_sub.html#var_ngas">NGAS</A> = 1
    integer, parameter :: <A HREF="test_growin_sub.html#var_nwave">NWAVE</A> = 0
    integer, parameter :: <A HREF="test_growin_sub.html#var_lunoprt">LUNOPRT</A> = 6
    integer :: <A HREF="test_growin_sub.html#var_maxsubsteps">maxsubsteps</A> = 32
    integer :: <A HREF="test_growin_sub.html#var_maxretries">maxretries</A> = 10
    real (kind=f), parameter :: <A HREF="test_growin_sub.html#var_dtime">dtime</A> = 1000._f
    real (kind=f), parameter :: <A HREF="test_growin_sub.html#var_deltaz">deltaz</A> = 100._f
    real (kind=f), parameter :: <A HREF="test_growin_sub.html#var_zmin">zmin</A> = 3000._f
    integer, parameter :: <A HREF="test_growin_sub.html#var_nstep">nstep</A> = 5000 / dtime
    integer, parameter :: <A HREF="test_growin_sub.html#var_i_h2o">I_H2O</A> = 1
    type (carma_type), target :: <A HREF="test_growin_sub.html#var_carma">carma</A>
    type (carma_type), pointer :: <A HREF="test_growin_sub.html#var_carma_ptr">carma_ptr</A>
    type (carmastate_type) :: <A HREF="test_growin_sub.html#var_cstate">cstate</A>
    integer :: <A HREF="test_growin_sub.html#var_rc">rc</A> = 0
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_zc">zc</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_zl">zl</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_p">p</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_pl">pl</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_t">t</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_relhum">relhum</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_rho">rho</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_cldfrc">cldfrc</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_rhcrit">rhcrit</A>
    real (kind=f), allocatable, dimension (:,:,:) :: <A HREF="test_growin_sub.html#var_mmr">mmr</A>
    real (kind=f), allocatable, dimension (:,:) :: <A HREF="test_growin_sub.html#var_mmr_gas">mmr_gas</A>
    real (kind=f), allocatable, dimension (:,:) :: <A HREF="test_growin_sub.html#var_mmr_gas_old">mmr_gas_old</A>
    real (kind=f), allocatable, dimension (:,:) :: <A HREF="test_growin_sub.html#var_satliq">satliq</A>
    real (kind=f), allocatable, dimension (:,:) :: <A HREF="test_growin_sub.html#var_satice">satice</A>
    real (kind=f), allocatable, dimension (:,:) :: <A HREF="test_growin_sub.html#var_pvapice">pvapice</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_r">r</A>
    real (kind=f), allocatable, dimension (:) :: <A HREF="test_growin_sub.html#var_rmass">rmass</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_lat">lat</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_lon">lon</A>
    integer :: <A HREF="test_growin_sub.html#var_i">i</A>
    integer :: <A HREF="test_growin_sub.html#var_istep">istep</A>
    integer :: <A HREF="test_growin_sub.html#var_igas">igas</A>
    integer :: <A HREF="test_growin_sub.html#var_igroup">igroup</A>
    integer :: <A HREF="test_growin_sub.html#var_ielem">ielem</A>
    integer :: <A HREF="test_growin_sub.html#var_ibin">ibin</A>
    integer, parameter :: <A HREF="test_growin_sub.html#var_lun">lun</A> = 42
    integer :: <A HREF="test_growin_sub.html#var_nsubsteps">nsubsteps</A>
    integer :: <A HREF="test_growin_sub.html#var_lastsub">lastsub</A> = 0
    real (kind=f) :: <A HREF="test_growin_sub.html#var_nretries">nretries</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_lastret">lastret</A> = 0._f
    real (kind=f) :: <A HREF="test_growin_sub.html#var_time">time</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_rmin">rmin</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_rmrat">rmrat</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_drh">drh</A>
    real (kind=f) :: <A HREF="test_growin_sub.html#var_t_orig">t_orig</A>

end subroutine test_growin_sub
</PRE>
 Just have one grid box. In that grid box, put an initial concentration
 of drops at the smallest size, then allow that to grow using a gas. The
 total mass of drops + gas should be conserved.
<P>
 Use substepping, which means that the model should start at ice saturation
 and then get a perturbation in the first timestep to the specified gas
 concentration.

<HR><H2> Description of Variables </H2>
<A NAME="var_nz"><H3>NZ</H3></A>
<PRE>integer, parameter :: NZ = 1
</PRE>
<A NAME="var_nzp1"><H3>NZP1</H3></A>
<PRE>integer, parameter :: NZP1 = NZ + 1
</PRE>
<A NAME="var_nelem"><H3>NELEM</H3></A>
<PRE>integer, parameter :: NELEM = 1
</PRE>
<A NAME="var_nbin"><H3>NBIN</H3></A>
<PRE>integer, parameter :: NBIN = 18
</PRE>
<A NAME="var_ngroup"><H3>NGROUP</H3></A>
<PRE>integer, parameter :: NGROUP = 1
</PRE>
<A NAME="var_nsolute"><H3>NSOLUTE</H3></A>
<PRE>integer, parameter :: NSOLUTE = 0
</PRE>
<A NAME="var_ngas"><H3>NGAS</H3></A>
<PRE>integer, parameter :: NGAS = 1
</PRE>
<A NAME="var_nwave"><H3>NWAVE</H3></A>
<PRE>integer, parameter :: NWAVE = 0
</PRE>
<A NAME="var_lunoprt"><H3>LUNOPRT</H3></A>
<PRE>integer, parameter :: LUNOPRT = 6
</PRE>
<A NAME="var_maxsubsteps"><H3>maxsubsteps</H3></A>
<PRE>integer :: maxsubsteps = 32
</PRE>
<A NAME="var_maxretries"><H3>maxretries</H3></A>
<PRE>integer :: maxretries = 10
</PRE>
<A NAME="var_dtime"><H3>dtime</H3></A>
<PRE>real (kind=f), parameter :: dtime = 1000._f
</PRE>
<A NAME="var_deltaz"><H3>deltaz</H3></A>
<PRE>real (kind=f), parameter :: deltaz = 100._f
</PRE>
<A NAME="var_zmin"><H3>zmin</H3></A>
<PRE>real (kind=f), parameter :: zmin = 3000._f
</PRE>
<A NAME="var_nstep"><H3>nstep</H3></A>
<PRE>integer, parameter :: nstep = 5000 / dtime
</PRE>
<A NAME="var_i_h2o"><H3>I_H2O</H3></A>
<PRE>integer, parameter :: I_H2O = 1
</PRE>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), target :: carma
</PRE>
<A NAME="var_carma_ptr"><H3>carma_ptr</H3></A>
<PRE>type (carma_type), pointer :: carma_ptr
</PRE>
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type) :: cstate
</PRE>
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer :: rc = 0
</PRE>
<A NAME="var_zc"><H3>zc</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: zc
</PRE>
<A NAME="var_zl"><H3>zl</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: zl
</PRE>
<A NAME="var_p"><H3>p</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: p
</PRE>
<A NAME="var_pl"><H3>pl</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: pl
</PRE>
<A NAME="var_t"><H3>t</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: t
</PRE>
<A NAME="var_relhum"><H3>relhum</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: relhum
</PRE>
<A NAME="var_rho"><H3>rho</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: rho
</PRE>
<A NAME="var_cldfrc"><H3>cldfrc</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: cldfrc
</PRE>
<A NAME="var_rhcrit"><H3>rhcrit</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: rhcrit
</PRE>
<A NAME="var_mmr"><H3>mmr</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:,:) :: mmr
</PRE>
<A NAME="var_mmr_gas"><H3>mmr_gas</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:) :: mmr_gas
</PRE>
<A NAME="var_mmr_gas_old"><H3>mmr_gas_old</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:) :: mmr_gas_old
</PRE>
<A NAME="var_satliq"><H3>satliq</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:) :: satliq
</PRE>
<A NAME="var_satice"><H3>satice</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:) :: satice
</PRE>
<A NAME="var_pvapice"><H3>pvapice</H3></A>
<PRE>real (kind=f), allocatable, dimension (:,:) :: pvapice
</PRE>
<A NAME="var_r"><H3>r</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: r
</PRE>
<A NAME="var_rmass"><H3>rmass</H3></A>
<PRE>real (kind=f), allocatable, dimension (:) :: rmass
</PRE>
<A NAME="var_lat"><H3>lat</H3></A>
<PRE>real (kind=f) :: lat
</PRE>
<A NAME="var_lon"><H3>lon</H3></A>
<PRE>real (kind=f) :: lon
</PRE>
<A NAME="var_i"><H3>i</H3></A>
<PRE>integer :: i
</PRE>
<A NAME="var_istep"><H3>istep</H3></A>
<PRE>integer :: istep
</PRE>
<A NAME="var_igas"><H3>igas</H3></A>
<PRE>integer :: igas
</PRE>
<A NAME="var_igroup"><H3>igroup</H3></A>
<PRE>integer :: igroup
</PRE>
<A NAME="var_ielem"><H3>ielem</H3></A>
<PRE>integer :: ielem
</PRE>
<A NAME="var_ibin"><H3>ibin</H3></A>
<PRE>integer :: ibin
</PRE>
<A NAME="var_lun"><H3>lun</H3></A>
<PRE>integer, parameter :: lun = 42
</PRE>
<A NAME="var_nsubsteps"><H3>nsubsteps</H3></A>
<PRE>integer :: nsubsteps
</PRE>
<A NAME="var_lastsub"><H3>lastsub</H3></A>
<PRE>integer :: lastsub = 0
</PRE>
<A NAME="var_nretries"><H3>nretries</H3></A>
<PRE>real (kind=f) :: nretries
</PRE>
<A NAME="var_lastret"><H3>lastret</H3></A>
<PRE>real (kind=f) :: lastret = 0._f
</PRE>
<A NAME="var_time"><H3>time</H3></A>
<PRE>real (kind=f) :: time
</PRE>
<A NAME="var_rmin"><H3>rmin</H3></A>
<PRE>real (kind=f) :: rmin
</PRE>
<A NAME="var_rmrat"><H3>rmrat</H3></A>
<PRE>real (kind=f) :: rmrat
</PRE>
<A NAME="var_drh"><H3>drh</H3></A>
<PRE>real (kind=f) :: drh
</PRE>
<A NAME="var_t_orig"><H3>t_orig</H3></A>
<PRE>real (kind=f) :: t_orig
</PRE>
</HTML>
