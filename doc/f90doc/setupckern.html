<HTML>
<HEAD>
   <TITLE> subroutine setupckern (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine setupckern </H1>
<PRE>subroutine setupckern

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="setupckern.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="setupckern.html#var_cstate">cstate</A>
    integer, intent(inout) :: <A HREF="setupckern.html#var_rc">rc</A>
    real (kind=f), dimension (NBIN,NBIN) :: <A HREF="setupckern.html#var_e_coll2">e_coll2</A>
    integer, parameter :: <A HREF="setupckern.html#var_np_data">NP_DATA</A> = 21
    integer, parameter :: <A HREF="setupckern.html#var_nr_data">NR_DATA</A> = 12
    real (kind=f), parameter :: <A HREF="setupckern.html#var_e_small">e_small</A> = 0.0001_f
    logical, save :: <A HREF="setupckern.html#var_init_data">init_data</A> = .FALSE.
    real (kind=f), save, dimension (NP_DATA) :: <A HREF="setupckern.html#var_data_p">data_p</A>
    real (kind=f), save, dimension (NR_DATA) :: <A HREF="setupckern.html#var_data_r">data_r</A>
    real (kind=f), save, dimension (NP_DATA, NR_DATA) :: <A HREF="setupckern.html#var_data_e">data_e</A>
    integer :: <A HREF="setupckern.html#var_ip">ip</A>
    integer :: <A HREF="setupckern.html#var_ig">ig</A>
    integer :: <A HREF="setupckern.html#var_jg">jg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_cstick_calc">cstick_calc</A>
    integer :: <A HREF="setupckern.html#var_i1">i1</A>
    integer :: <A HREF="setupckern.html#var_i2">i2</A>
    integer :: <A HREF="setupckern.html#var_j1">j1</A>
    integer :: <A HREF="setupckern.html#var_j2">j2</A>
    integer :: <A HREF="setupckern.html#var_k">k</A>
    integer :: <A HREF="setupckern.html#var_i">i</A>
    integer :: <A HREF="setupckern.html#var_j">j</A>
    integer :: <A HREF="setupckern.html#var_igrp">igrp</A>
    integer :: <A HREF="setupckern.html#var_ibin">ibin</A>
    real (kind=f) :: <A HREF="setupckern.html#var_rhoa_cgs">rhoa_cgs</A>
    real (kind=f) :: <A HREF="setupckern.html#var_temp1">temp1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_temp2">temp2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_r1">r1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_di">di</A>
    real (kind=f) :: <A HREF="setupckern.html#var_gi">gi</A>
    real (kind=f) :: <A HREF="setupckern.html#var_rlbi">rlbi</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dti1">dti1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dti2">dti2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dti">dti</A>
    real (kind=f) :: <A HREF="setupckern.html#var_r2">r2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dj">dj</A>
    real (kind=f) :: <A HREF="setupckern.html#var_gj">gj</A>
    real (kind=f) :: <A HREF="setupckern.html#var_rlbj">rlbj</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dtj1">dtj1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dtj2">dtj2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dtj">dtj</A>
    real (kind=f) :: <A HREF="setupckern.html#var_rp">rp</A>
    real (kind=f) :: <A HREF="setupckern.html#var_dp">dp</A>
    real (kind=f) :: <A HREF="setupckern.html#var_gg">gg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_delt">delt</A>
    real (kind=f) :: <A HREF="setupckern.html#var_term1">term1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_term2">term2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_cbr">cbr</A>
    real (kind=f) :: <A HREF="setupckern.html#var_r_larg">r_larg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_r_smal">r_smal</A>
    integer :: <A HREF="setupckern.html#var_i_larg">i_larg</A>
    integer :: <A HREF="setupckern.html#var_i_smal">i_smal</A>
    integer :: <A HREF="setupckern.html#var_ig_larg">ig_larg</A>
    integer :: <A HREF="setupckern.html#var_ig_smal">ig_smal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_d_larg">d_larg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_re_larg">re_larg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_pe">pe</A>
    real (kind=f) :: <A HREF="setupckern.html#var_pe3">pe3</A>
    real (kind=f) :: <A HREF="setupckern.html#var_ccd">ccd</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e_coll">e_coll</A>
    real (kind=f) :: <A HREF="setupckern.html#var_vfc_smal">vfc_smal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_vfc_larg">vfc_larg</A>
    real (kind=f) :: <A HREF="setupckern.html#var_sk">sk</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e1">e1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e3">e3</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e_langmuir">e_langmuir</A>
    real (kind=f) :: <A HREF="setupckern.html#var_re60">re60</A>
    real (kind=f) :: <A HREF="setupckern.html#var_pr">pr</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e_fuchs">e_fuchs</A>
    integer :: <A HREF="setupckern.html#var_jp">jp</A>
    integer :: <A HREF="setupckern.html#var_jj">jj</A>
    integer :: <A HREF="setupckern.html#var_jr">jr</A>
    real (kind=f) :: <A HREF="setupckern.html#var_pblni">pblni</A>
    real (kind=f) :: <A HREF="setupckern.html#var_rblni">rblni</A>
    real (kind=f) :: <A HREF="setupckern.html#var_term3">term3</A>
    real (kind=f) :: <A HREF="setupckern.html#var_term4">term4</A>
    real (kind=f) :: <A HREF="setupckern.html#var_beta">beta</A>
    real (kind=f) :: <A HREF="setupckern.html#var_b_coal">b_coal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_a_coal">a_coal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_x_coal">x_coal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_e_coal">e_coal</A>
    real (kind=f) :: <A HREF="setupckern.html#var_vfc_1">vfc_1</A>
    real (kind=f) :: <A HREF="setupckern.html#var_vfc_2">vfc_2</A>
    real (kind=f) :: <A HREF="setupckern.html#var_cgr">cgr</A>
    real (kind=f), parameter :: <A HREF="setupckern.html#var_vwa1">vwa1</A> = 0.0757_f
    real (kind=f), parameter :: <A HREF="setupckern.html#var_vwa3">vwa3</A> = 0.0015_f
    real (kind=f), parameter :: <A HREF="setupckern.html#var_vwb0">vwb0</A> = 0.0151_f
    real (kind=f), parameter :: <A HREF="setupckern.html#var_vwb1">vwb1</A> = -0.186_f
    real (kind=f), parameter :: <A HREF="setupckern.html#var_vwb3">vwb3</A> = -0.0163_f
    real (kind=f), parameter :: <A HREF="setupckern.html#var_ham">ham</A> = 6.4e-13_f
    real (kind=f) :: <A HREF="setupckern.html#var_hp">hp</A>
    real (kind=f) :: <A HREF="setupckern.html#var_hpln">hpln</A>
    real (kind=f) :: <A HREF="setupckern.html#var_enot">Enot</A>
    real (kind=f) :: <A HREF="setupckern.html#var_einf">Einf</A>
    logical, dimension (NGROUP, NGROUP) :: <A HREF="setupckern.html#var_use_vw">use_vw</A>
    integer :: <A HREF="setupckern.html#var_ielem">ielem</A>

end subroutine setupckern
</PRE>
  This routine evaluates the coagulation kernels, ckernel(k,j1,j2,i1,i2)
  [cm^3 s^-1] and pkernel. Indices correspond to aritrary array of columns <ic, iy>
  vertical level <k>, aerosol groups <j1,j2> and bins <i1,i2> of colliding particles.
<P>
  ckernel is calculated as a static array for use each timestep
  ckern0 is also created for a basis to calculate new ckernels each timestep, if desired. (coagwet.f)
<P>
  This routine requires that vertical profiles of temperature <T>,
  air density <rhoa>, and viscosity <rmu> are defined.
<P>
<STRONG>Author:</STRONG> Andy Ackerman
<P>
<STRONG>Version:</STRONG> Oct-1995

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_e_coll2"><H3>e_coll2</H3></A>
<PRE>real (kind=f), dimension (NBIN,NBIN) :: e_coll2
</PRE>
<A NAME="var_np_data"><H3>NP_DATA</H3></A>
<PRE>integer, parameter :: NP_DATA = 21
</PRE>
<A NAME="var_nr_data"><H3>NR_DATA</H3></A>
<PRE>integer, parameter :: NR_DATA = 12
</PRE>
<A NAME="var_e_small"><H3>e_small</H3></A>
<PRE>real (kind=f), parameter :: e_small = 0.0001_f
</PRE>
<A NAME="var_init_data"><H3>init_data</H3></A>
<PRE>logical, save :: init_data = .FALSE.
</PRE>
<A NAME="var_data_p"><H3>data_p</H3></A>
<PRE>real (kind=f), save, dimension (NP_DATA) :: data_p
</PRE>
<A NAME="var_data_r"><H3>data_r</H3></A>
<PRE>real (kind=f), save, dimension (NR_DATA) :: data_r
</PRE>
<A NAME="var_data_e"><H3>data_e</H3></A>
<PRE>real (kind=f), save, dimension (NP_DATA, NR_DATA) :: data_e
</PRE>
<A NAME="var_ip"><H3>ip</H3></A>
<PRE>integer :: ip
</PRE>
<A NAME="var_ig"><H3>ig</H3></A>
<PRE>integer :: ig
</PRE>
<A NAME="var_jg"><H3>jg</H3></A>
<PRE>integer :: jg
</PRE>
<A NAME="var_cstick_calc"><H3>cstick_calc</H3></A>
<PRE>real (kind=f) :: cstick_calc
</PRE>
<A NAME="var_i1"><H3>i1</H3></A>
<PRE>integer :: i1
</PRE>
<A NAME="var_i2"><H3>i2</H3></A>
<PRE>integer :: i2
</PRE>
<A NAME="var_j1"><H3>j1</H3></A>
<PRE>integer :: j1
</PRE>
<A NAME="var_j2"><H3>j2</H3></A>
<PRE>integer :: j2
</PRE>
<A NAME="var_k"><H3>k</H3></A>
<PRE>integer :: k
</PRE>
<A NAME="var_i"><H3>i</H3></A>
<PRE>integer :: i
</PRE>
<A NAME="var_j"><H3>j</H3></A>
<PRE>integer :: j
</PRE>
<A NAME="var_igrp"><H3>igrp</H3></A>
<PRE>integer :: igrp
</PRE>
<A NAME="var_ibin"><H3>ibin</H3></A>
<PRE>integer :: ibin
</PRE>
<A NAME="var_rhoa_cgs"><H3>rhoa_cgs</H3></A>
<PRE>real (kind=f) :: rhoa_cgs
</PRE>
<A NAME="var_temp1"><H3>temp1</H3></A>
<PRE>real (kind=f) :: temp1
</PRE>
<A NAME="var_temp2"><H3>temp2</H3></A>
<PRE>real (kind=f) :: temp2
</PRE>
<A NAME="var_r1"><H3>r1</H3></A>
<PRE>real (kind=f) :: r1
</PRE>
<A NAME="var_di"><H3>di</H3></A>
<PRE>real (kind=f) :: di
</PRE>
<A NAME="var_gi"><H3>gi</H3></A>
<PRE>real (kind=f) :: gi
</PRE>
<A NAME="var_rlbi"><H3>rlbi</H3></A>
<PRE>real (kind=f) :: rlbi
</PRE>
<A NAME="var_dti1"><H3>dti1</H3></A>
<PRE>real (kind=f) :: dti1
</PRE>
<A NAME="var_dti2"><H3>dti2</H3></A>
<PRE>real (kind=f) :: dti2
</PRE>
<A NAME="var_dti"><H3>dti</H3></A>
<PRE>real (kind=f) :: dti
</PRE>
<A NAME="var_r2"><H3>r2</H3></A>
<PRE>real (kind=f) :: r2
</PRE>
<A NAME="var_dj"><H3>dj</H3></A>
<PRE>real (kind=f) :: dj
</PRE>
<A NAME="var_gj"><H3>gj</H3></A>
<PRE>real (kind=f) :: gj
</PRE>
<A NAME="var_rlbj"><H3>rlbj</H3></A>
<PRE>real (kind=f) :: rlbj
</PRE>
<A NAME="var_dtj1"><H3>dtj1</H3></A>
<PRE>real (kind=f) :: dtj1
</PRE>
<A NAME="var_dtj2"><H3>dtj2</H3></A>
<PRE>real (kind=f) :: dtj2
</PRE>
<A NAME="var_dtj"><H3>dtj</H3></A>
<PRE>real (kind=f) :: dtj
</PRE>
<A NAME="var_rp"><H3>rp</H3></A>
<PRE>real (kind=f) :: rp
</PRE>
<A NAME="var_dp"><H3>dp</H3></A>
<PRE>real (kind=f) :: dp
</PRE>
<A NAME="var_gg"><H3>gg</H3></A>
<PRE>real (kind=f) :: gg
</PRE>
<A NAME="var_delt"><H3>delt</H3></A>
<PRE>real (kind=f) :: delt
</PRE>
<A NAME="var_term1"><H3>term1</H3></A>
<PRE>real (kind=f) :: term1
</PRE>
<A NAME="var_term2"><H3>term2</H3></A>
<PRE>real (kind=f) :: term2
</PRE>
<A NAME="var_cbr"><H3>cbr</H3></A>
<PRE>real (kind=f) :: cbr
</PRE>
<A NAME="var_r_larg"><H3>r_larg</H3></A>
<PRE>real (kind=f) :: r_larg
</PRE>
<A NAME="var_r_smal"><H3>r_smal</H3></A>
<PRE>real (kind=f) :: r_smal
</PRE>
<A NAME="var_i_larg"><H3>i_larg</H3></A>
<PRE>integer :: i_larg
</PRE>
<A NAME="var_i_smal"><H3>i_smal</H3></A>
<PRE>integer :: i_smal
</PRE>
<A NAME="var_ig_larg"><H3>ig_larg</H3></A>
<PRE>integer :: ig_larg
</PRE>
<A NAME="var_ig_smal"><H3>ig_smal</H3></A>
<PRE>integer :: ig_smal
</PRE>
<A NAME="var_d_larg"><H3>d_larg</H3></A>
<PRE>real (kind=f) :: d_larg
</PRE>
<A NAME="var_re_larg"><H3>re_larg</H3></A>
<PRE>real (kind=f) :: re_larg
</PRE>
<A NAME="var_pe"><H3>pe</H3></A>
<PRE>real (kind=f) :: pe
</PRE>
<A NAME="var_pe3"><H3>pe3</H3></A>
<PRE>real (kind=f) :: pe3
</PRE>
<A NAME="var_ccd"><H3>ccd</H3></A>
<PRE>real (kind=f) :: ccd
</PRE>
<A NAME="var_e_coll"><H3>e_coll</H3></A>
<PRE>real (kind=f) :: e_coll
</PRE>
<A NAME="var_vfc_smal"><H3>vfc_smal</H3></A>
<PRE>real (kind=f) :: vfc_smal
</PRE>
<A NAME="var_vfc_larg"><H3>vfc_larg</H3></A>
<PRE>real (kind=f) :: vfc_larg
</PRE>
<A NAME="var_sk"><H3>sk</H3></A>
<PRE>real (kind=f) :: sk
</PRE>
<A NAME="var_e1"><H3>e1</H3></A>
<PRE>real (kind=f) :: e1
</PRE>
<A NAME="var_e3"><H3>e3</H3></A>
<PRE>real (kind=f) :: e3
</PRE>
<A NAME="var_e_langmuir"><H3>e_langmuir</H3></A>
<PRE>real (kind=f) :: e_langmuir
</PRE>
<A NAME="var_re60"><H3>re60</H3></A>
<PRE>real (kind=f) :: re60
</PRE>
<A NAME="var_pr"><H3>pr</H3></A>
<PRE>real (kind=f) :: pr
</PRE>
<A NAME="var_e_fuchs"><H3>e_fuchs</H3></A>
<PRE>real (kind=f) :: e_fuchs
</PRE>
<A NAME="var_jp"><H3>jp</H3></A>
<PRE>integer :: jp
</PRE>
<A NAME="var_jj"><H3>jj</H3></A>
<PRE>integer :: jj
</PRE>
<A NAME="var_jr"><H3>jr</H3></A>
<PRE>integer :: jr
</PRE>
<A NAME="var_pblni"><H3>pblni</H3></A>
<PRE>real (kind=f) :: pblni
</PRE>
<A NAME="var_rblni"><H3>rblni</H3></A>
<PRE>real (kind=f) :: rblni
</PRE>
<A NAME="var_term3"><H3>term3</H3></A>
<PRE>real (kind=f) :: term3
</PRE>
<A NAME="var_term4"><H3>term4</H3></A>
<PRE>real (kind=f) :: term4
</PRE>
<A NAME="var_beta"><H3>beta</H3></A>
<PRE>real (kind=f) :: beta
</PRE>
<A NAME="var_b_coal"><H3>b_coal</H3></A>
<PRE>real (kind=f) :: b_coal
</PRE>
<A NAME="var_a_coal"><H3>a_coal</H3></A>
<PRE>real (kind=f) :: a_coal
</PRE>
<A NAME="var_x_coal"><H3>x_coal</H3></A>
<PRE>real (kind=f) :: x_coal
</PRE>
<A NAME="var_e_coal"><H3>e_coal</H3></A>
<PRE>real (kind=f) :: e_coal
</PRE>
<A NAME="var_vfc_1"><H3>vfc_1</H3></A>
<PRE>real (kind=f) :: vfc_1
</PRE>
<A NAME="var_vfc_2"><H3>vfc_2</H3></A>
<PRE>real (kind=f) :: vfc_2
</PRE>
<A NAME="var_cgr"><H3>cgr</H3></A>
<PRE>real (kind=f) :: cgr
</PRE>
<A NAME="var_vwa1"><H3>vwa1</H3></A>
<PRE>real (kind=f), parameter :: vwa1 = 0.0757_f
</PRE>
<A NAME="var_vwa3"><H3>vwa3</H3></A>
<PRE>real (kind=f), parameter :: vwa3 = 0.0015_f
</PRE>
<A NAME="var_vwb0"><H3>vwb0</H3></A>
<PRE>real (kind=f), parameter :: vwb0 = 0.0151_f
</PRE>
<A NAME="var_vwb1"><H3>vwb1</H3></A>
<PRE>real (kind=f), parameter :: vwb1 = -0.186_f
</PRE>
<A NAME="var_vwb3"><H3>vwb3</H3></A>
<PRE>real (kind=f), parameter :: vwb3 = -0.0163_f
</PRE>
<A NAME="var_ham"><H3>ham</H3></A>
<PRE>real (kind=f), parameter :: ham = 6.4e-13_f
</PRE>
<A NAME="var_hp"><H3>hp</H3></A>
<PRE>real (kind=f) :: hp
</PRE>
<A NAME="var_hpln"><H3>hpln</H3></A>
<PRE>real (kind=f) :: hpln
</PRE>
<A NAME="var_enot"><H3>Enot</H3></A>
<PRE>real (kind=f) :: Enot
</PRE>
<A NAME="var_einf"><H3>Einf</H3></A>
<PRE>real (kind=f) :: Einf
</PRE>
<A NAME="var_use_vw"><H3>use_vw</H3></A>
<PRE>logical, dimension (NGROUP, NGROUP) :: use_vw
</PRE>
<A NAME="var_ielem"><H3>ielem</H3></A>
<PRE>integer :: ielem
</PRE>
</HTML>
