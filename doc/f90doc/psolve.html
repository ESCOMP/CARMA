<HTML>
<HEAD>
   <TITLE> subroutine psolve (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine psolve </H1>
<PRE>subroutine psolve

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Calls
    call <A HREF="smallconc.html">smallconc</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="psolve.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="psolve.html#var_cstate">cstate</A>
    integer, intent(in) :: <A HREF="psolve.html#var_iz">iz</A>
    integer, intent(in) :: <A HREF="psolve.html#var_ibin">ibin</A>
    integer, intent(in) :: <A HREF="psolve.html#var_ielem">ielem</A>
    integer, intent(inout) :: <A HREF="psolve.html#var_rc">rc</A>
    integer :: <A HREF="psolve.html#var_igroup">igroup</A>
    integer :: <A HREF="psolve.html#var_iepart">iepart</A>
    integer :: <A HREF="psolve.html#var_igto">igto</A>
    integer :: <A HREF="psolve.html#var_iz_no_sed">iz_no_sed</A>
    real (kind=f) :: <A HREF="psolve.html#var_ppd">ppd</A>
    real (kind=f) :: <A HREF="psolve.html#var_pc_nonuc">pc_nonuc</A>
    real (kind=f) :: <A HREF="psolve.html#var_pls">pls</A>
    real (kind=f) :: <A HREF="psolve.html#var_sed_rate">sed_rate</A>
    real (kind=f) :: <A HREF="psolve.html#var_rnuclgtot">rnuclgtot</A>
    real (kind=f) :: <A HREF="psolve.html#var_dsed">dsed</A>

end subroutine psolve
</PRE>
  This routine calculates new particle concentrations.
<P>
   The basic form from which the solution is derived is
   ( new_value - old_value ) / dtime = source_term - loss_rate*new_value
<P>
  Modified  Sep-1997  (McKie)
    New particle concentrations due to coagulation processes
    were moved to the csolve routine.  Csolve is called to
    update particle concentrations due to coagulation.
    This new psolve now updates particle concentrations due
    to the faster calcs of the non-coag microphysical processes.
<P>
<STRONG>Author:</STRONG> Eric Jensen, Bill McKie
<P>
<STRONG>Version:</STRONG> Oct-1995, Sep-1997

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_iz"><H3>iz</H3></A>
<PRE>integer, intent(in) :: iz
</PRE>
 z index
<A NAME="var_ibin"><H3>ibin</H3></A>
<PRE>integer, intent(in) :: ibin
</PRE>
 bin index
<A NAME="var_ielem"><H3>ielem</H3></A>
<PRE>integer, intent(in) :: ielem
</PRE>
 element index
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_igroup"><H3>igroup</H3></A>
<PRE>integer :: igroup
</PRE>
<A NAME="var_iepart"><H3>iepart</H3></A>
<PRE>integer :: iepart
</PRE>
<A NAME="var_igto"><H3>igto</H3></A>
<PRE>integer :: igto
</PRE>
<A NAME="var_iz_no_sed"><H3>iz_no_sed</H3></A>
<PRE>integer :: iz_no_sed
</PRE>
<A NAME="var_ppd"><H3>ppd</H3></A>
<PRE>real (kind=f) :: ppd
</PRE>
<A NAME="var_pc_nonuc"><H3>pc_nonuc</H3></A>
<PRE>real (kind=f) :: pc_nonuc
</PRE>
<A NAME="var_pls"><H3>pls</H3></A>
<PRE>real (kind=f) :: pls
</PRE>
<A NAME="var_sed_rate"><H3>sed_rate</H3></A>
<PRE>real (kind=f) :: sed_rate
</PRE>
<A NAME="var_rnuclgtot"><H3>rnuclgtot</H3></A>
<PRE>real (kind=f) :: rnuclgtot
</PRE>
<A NAME="var_dsed"><H3>dsed</H3></A>
<PRE>real (kind=f) :: dsed
</PRE>
</HTML>
