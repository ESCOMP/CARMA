<HTML>
<HEAD>
   <TITLE> subroutine vertadv (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine vertadv </H1>
<PRE>subroutine vertadv

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="vertadv.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="vertadv.html#var_cstate">cstate</A>
    real (kind=f), intent(inout), dimension (NZP1) :: <A HREF="vertadv.html#var_vtrans">vtrans</A>
    real (kind=f), intent(in), dimension (NZ) :: <A HREF="vertadv.html#var_cvert">cvert</A>
    integer, intent(in) :: <A HREF="vertadv.html#var_itbnd">itbnd</A>
    integer, intent(in) :: <A HREF="vertadv.html#var_ibbnd">ibbnd</A>
    real (kind=f), intent(in) :: <A HREF="vertadv.html#var_cvert_tbnd">cvert_tbnd</A>
    real (kind=f), intent(in) :: <A HREF="vertadv.html#var_cvert_bbnd">cvert_bbnd</A>
    real (kind=f), intent(out), dimension (NZP1) :: <A HREF="vertadv.html#var_vertadvu">vertadvu</A>
    real (kind=f), intent(out), dimension (NZP1) :: <A HREF="vertadv.html#var_vertadvd">vertadvd</A>
    integer, intent(inout) :: <A HREF="vertadv.html#var_rc">rc</A>
    integer :: <A HREF="vertadv.html#var_k">k</A>
    integer :: <A HREF="vertadv.html#var_nzm1">nzm1</A>
    integer :: <A HREF="vertadv.html#var_nzm2">nzm2</A>
    integer :: <A HREF="vertadv.html#var_itwo">itwo</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_dela">dela</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_delma">delma</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_aju">aju</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_ar">ar</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_al">al</A>
    real (kind=f), dimension (NZ) :: <A HREF="vertadv.html#var_a6">a6</A>
    real (kind=f) :: <A HREF="vertadv.html#var_dpc">dpc</A>
    real (kind=f) :: <A HREF="vertadv.html#var_dpc1">dpc1</A>
    real (kind=f) :: <A HREF="vertadv.html#var_dpcm1">dpcm1</A>
    real (kind=f) :: <A HREF="vertadv.html#var_ratt1">ratt1</A>
    real (kind=f) :: <A HREF="vertadv.html#var_ratt2">ratt2</A>
    real (kind=f) :: <A HREF="vertadv.html#var_ratt3">ratt3</A>
    real (kind=f) :: <A HREF="vertadv.html#var_rat1">rat1</A>
    real (kind=f) :: <A HREF="vertadv.html#var_rat2">rat2</A>
    real (kind=f) :: <A HREF="vertadv.html#var_rat3">rat3</A>
    real (kind=f) :: <A HREF="vertadv.html#var_rat4">rat4</A>
    real (kind=f) :: <A HREF="vertadv.html#var_den1">den1</A>
    real (kind=f) :: <A HREF="vertadv.html#var_com2">com2</A>
    real (kind=f) :: <A HREF="vertadv.html#var_x">x</A>
    real (kind=f) :: <A HREF="vertadv.html#var_xpos">xpos</A>
    real (kind=f) :: <A HREF="vertadv.html#var_cvert0">cvert0</A>
    real (kind=f) :: <A HREF="vertadv.html#var_cvertnzp1">cvertnzp1</A>

end subroutine vertadv
</PRE>
  This routine calculates vertrical advection rates using
  Piecewise Polynomial Method [Colela and Woodard, J. Comp. Phys.,
  54, 174-201, 1984]
<P>
<STRONG>Author:</STRONG> Eric Jensen
<P>
<STRONG>Version:</STRONG> Dec-1996

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_vtrans"><H3>vtrans</H3></A>
<PRE>real (kind=f), intent(inout), dimension (NZP1) :: vtrans
</PRE>
 vertical velocity
<A NAME="var_cvert"><H3>cvert</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZ) :: cvert
</PRE>
 quantity being transported
<A NAME="var_itbnd"><H3>itbnd</H3></A>
<PRE>integer, intent(in) :: itbnd
</PRE>
 top boundary condition
<A NAME="var_ibbnd"><H3>ibbnd</H3></A>
<PRE>integer, intent(in) :: ibbnd
</PRE>
 bottom boundary condition
<A NAME="var_cvert_tbnd"><H3>cvert_tbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_tbnd
</PRE>
 quantity at top boundary
<A NAME="var_cvert_bbnd"><H3>cvert_bbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_bbnd
</PRE>
 quantity at bottom boundary
<A NAME="var_vertadvu"><H3>vertadvu</H3></A>
<PRE>real (kind=f), intent(out), dimension (NZP1) :: vertadvu
</PRE>
 upward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_vertadvd"><H3>vertadvd</H3></A>
<PRE>real (kind=f), intent(out), dimension (NZP1) :: vertadvd
</PRE>
 downward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_k"><H3>k</H3></A>
<PRE>integer :: k
</PRE>
<A NAME="var_nzm1"><H3>nzm1</H3></A>
<PRE>integer :: nzm1
</PRE>
<A NAME="var_nzm2"><H3>nzm2</H3></A>
<PRE>integer :: nzm2
</PRE>
<A NAME="var_itwo"><H3>itwo</H3></A>
<PRE>integer :: itwo
</PRE>
<A NAME="var_dela"><H3>dela</H3></A>
<PRE>real (kind=f), dimension (NZ) :: dela
</PRE>
<A NAME="var_delma"><H3>delma</H3></A>
<PRE>real (kind=f), dimension (NZ) :: delma
</PRE>
<A NAME="var_aju"><H3>aju</H3></A>
<PRE>real (kind=f), dimension (NZ) :: aju
</PRE>
<A NAME="var_ar"><H3>ar</H3></A>
<PRE>real (kind=f), dimension (NZ) :: ar
</PRE>
<A NAME="var_al"><H3>al</H3></A>
<PRE>real (kind=f), dimension (NZ) :: al
</PRE>
<A NAME="var_a6"><H3>a6</H3></A>
<PRE>real (kind=f), dimension (NZ) :: a6
</PRE>
<A NAME="var_dpc"><H3>dpc</H3></A>
<PRE>real (kind=f) :: dpc
</PRE>
<A NAME="var_dpc1"><H3>dpc1</H3></A>
<PRE>real (kind=f) :: dpc1
</PRE>
<A NAME="var_dpcm1"><H3>dpcm1</H3></A>
<PRE>real (kind=f) :: dpcm1
</PRE>
<A NAME="var_ratt1"><H3>ratt1</H3></A>
<PRE>real (kind=f) :: ratt1
</PRE>
<A NAME="var_ratt2"><H3>ratt2</H3></A>
<PRE>real (kind=f) :: ratt2
</PRE>
<A NAME="var_ratt3"><H3>ratt3</H3></A>
<PRE>real (kind=f) :: ratt3
</PRE>
<A NAME="var_rat1"><H3>rat1</H3></A>
<PRE>real (kind=f) :: rat1
</PRE>
<A NAME="var_rat2"><H3>rat2</H3></A>
<PRE>real (kind=f) :: rat2
</PRE>
<A NAME="var_rat3"><H3>rat3</H3></A>
<PRE>real (kind=f) :: rat3
</PRE>
<A NAME="var_rat4"><H3>rat4</H3></A>
<PRE>real (kind=f) :: rat4
</PRE>
<A NAME="var_den1"><H3>den1</H3></A>
<PRE>real (kind=f) :: den1
</PRE>
<A NAME="var_com2"><H3>com2</H3></A>
<PRE>real (kind=f) :: com2
</PRE>
<A NAME="var_x"><H3>x</H3></A>
<PRE>real (kind=f) :: x
</PRE>
<A NAME="var_xpos"><H3>xpos</H3></A>
<PRE>real (kind=f) :: xpos
</PRE>
<A NAME="var_cvert0"><H3>cvert0</H3></A>
<PRE>real (kind=f) :: cvert0
</PRE>
<A NAME="var_cvertnzp1"><H3>cvertnzp1</H3></A>
<PRE>real (kind=f) :: cvertnzp1
</PRE>
</HTML>
