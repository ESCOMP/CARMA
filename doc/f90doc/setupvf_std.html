<HTML>
<HEAD>
   <TITLE> subroutine setupvf_std (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine setupvf_std </H1>
<PRE>subroutine setupvf_std

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="setupvf_std.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="setupvf_std.html#var_cstate">cstate</A>
    integer, intent(in) :: <A HREF="setupvf_std.html#var_j">j</A>
    integer, intent(inout) :: <A HREF="setupvf_std.html#var_rc">rc</A>
    integer :: <A HREF="setupvf_std.html#var_i">i</A>
    integer :: <A HREF="setupvf_std.html#var_k">k</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_x">x</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_y">y</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_cdrag">cdrag</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_rhoa_cgs">rhoa_cgs</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_vg">vg</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_rmfp">rmfp</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_rkn">rkn</A>
    real (kind=f) :: <A HREF="setupvf_std.html#var_expon">expon</A>

end subroutine setupvf_std
</PRE>
 This routine evaluates particle fall velocities, vf(k) [cm s^-1]
 and reynolds' numbers based on fall velocities, re(j,i,k) [dimensionless].
 indices correspond to vertical level <k>, bin index <i>, and aerosol
 group <j>.
<P>
 Method: first use Stokes flow (with Fuchs' size corrections,
 valid only for Stokes flow) to estimate fall velocity, then calculate
 Reynolds' number (Re) (for spheres, Stokes drag coefficient is 24/Re).
 Then for Re > 1, correct drag coefficient (Cd) for turbulent boundary
 layer through standard trick to solving the drag problem:
 fit y = log( Re ) as a function of x = log( Cd Re^2 ).
 We use the data for rigid spheres taken from Figure 10-6 of
 Pruppacher and Klett (1978):
<P>
  Re     Cd
 <UL>
 <LI> ----  ------
    1    24
   10     4.3
  100     1.1
 1000     0.45
<P>
 Note that we ignore the "drag crisis" at Re > 200,000
 (as discussed on p. 341 and shown in Fig 10-36 of P&K 1978), where
 Cd drops dramatically to 0.2 for smooth, rigid spheres, and instead
 assume Cd = 0.45 for Re > 1,000
<P>
 Note that we also ignore hydrodynamic deformation of liquid droplets
 as well as any breakup due to Rayleigh-Taylor instability.
<P>
 This routine requires that vertical profiles of temperature <t>,
 air density <rhoa>, and viscosity <rmu> are defined (i.e., initatm.f
 must be called before this).  The vertical profile with ix = iy = 1
 is used.
<P>
 We assume spherical particles -- call setupvf_std_shape() to use legacy
 code from old Toon model for non-spherical effects -- use (better
 yet, fix) at own risk.
<P>
 Added support for the particle radius being dependent on the relative
 humidity according to the parameterizations of Gerber [1995] and
 Fitzgerald [1975]. The fall velocity is then based upon the wet radius
 rather than the dry radius. For particles that are not subject to
 swelling, the wet and dry radii are the same.
<P>
 </UL>
<P>
<STRONG>Author:</STRONG> Chuck Bardeen, Pete Colarco from Andy Ackerman
<P>
<STRONG>Version:</STRONG> Mar-2010 from Nov-2000

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_j"><H3>j</H3></A>
<PRE>integer, intent(in) :: j
</PRE>
 group index
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_i"><H3>i</H3></A>
<PRE>integer :: i
</PRE>
<A NAME="var_k"><H3>k</H3></A>
<PRE>integer :: k
</PRE>
<A NAME="var_x"><H3>x</H3></A>
<PRE>real (kind=f) :: x
</PRE>
<A NAME="var_y"><H3>y</H3></A>
<PRE>real (kind=f) :: y
</PRE>
<A NAME="var_cdrag"><H3>cdrag</H3></A>
<PRE>real (kind=f) :: cdrag
</PRE>
<A NAME="var_rhoa_cgs"><H3>rhoa_cgs</H3></A>
<PRE>real (kind=f) :: rhoa_cgs
</PRE>
<A NAME="var_vg"><H3>vg</H3></A>
<PRE>real (kind=f) :: vg
</PRE>
<A NAME="var_rmfp"><H3>rmfp</H3></A>
<PRE>real (kind=f) :: rmfp
</PRE>
<A NAME="var_rkn"><H3>rkn</H3></A>
<PRE>real (kind=f) :: rkn
</PRE>
<A NAME="var_expon"><H3>expon</H3></A>
<PRE>real (kind=f) :: expon
</PRE>
</HTML>
