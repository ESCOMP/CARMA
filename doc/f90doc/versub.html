<HTML>
<HEAD>
   <TITLE> subroutine versub (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine versub </H1>
<PRE>subroutine versub

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="versub.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="versub.html#var_cstate">cstate</A>
    real (kind=f), intent(in), dimension (NZ) :: <A HREF="versub.html#var_pcmax">pcmax</A>
    real (kind=f), intent(inout), dimension (NZ) :: <A HREF="versub.html#var_cvert">cvert</A>
    integer, intent(in) :: <A HREF="versub.html#var_itbnd">itbnd</A>
    integer, intent(in) :: <A HREF="versub.html#var_ibbnd">ibbnd</A>
    real (kind=f), intent(in) :: <A HREF="versub.html#var_ftop">ftop</A>
    real (kind=f), intent(in) :: <A HREF="versub.html#var_fbot">fbot</A>
    real (kind=f), intent(in) :: <A HREF="versub.html#var_cvert_tbnd">cvert_tbnd</A>
    real (kind=f), intent(in) :: <A HREF="versub.html#var_cvert_bbnd">cvert_bbnd</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versub.html#var_vertadvu">vertadvu</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versub.html#var_vertadvd">vertadvd</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versub.html#var_vertdifu">vertdifu</A>
    real (kind=f), intent(in), dimension (NZP1) :: <A HREF="versub.html#var_vertdifd">vertdifd</A>
    integer, intent(inout) :: <A HREF="versub.html#var_rc">rc</A>
    integer :: <A HREF="versub.html#var_iz">iz</A>
    integer :: <A HREF="versub.html#var_istep">istep</A>
    integer :: <A HREF="versub.html#var_nstep_sed">nstep_sed</A>
    real (kind=f), dimension (NZ) :: <A HREF="versub.html#var_fvert">fvert</A>
    real (kind=f), dimension (NZP1) :: <A HREF="versub.html#var_up">up</A>
    real (kind=f), dimension (NZP1) :: <A HREF="versub.html#var_dn">dn</A>
    real (kind=f) :: <A HREF="versub.html#var_cfl_max">cfl_max</A>
    real (kind=f) :: <A HREF="versub.html#var_fvert_1">fvert_1</A>
    real (kind=f) :: <A HREF="versub.html#var_fvert_nz">fvert_nz</A>

end subroutine versub
</PRE>
  This routine solves for sedimentation using an explicit substepping approach. It
  is faster and handles large cfl and irregular grids better than the normal PPM
  solver (versol), but it is more diffusive.
<P>
 version Aug 2010
<P>
<STRONG>Author:</STRONG> Andy Ackerman, Chuck Bardeen

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_pcmax"><H3>pcmax</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZ) :: pcmax
</PRE>
 maximum particle concentration (#/x/y/z)
<A NAME="var_cvert"><H3>cvert</H3></A>
<PRE>real (kind=f), intent(inout), dimension (NZ) :: cvert
</PRE>
 quantity being transported (#/x/y/z)
<A NAME="var_itbnd"><H3>itbnd</H3></A>
<PRE>integer, intent(in) :: itbnd
</PRE>
 top boundary condition
<A NAME="var_ibbnd"><H3>ibbnd</H3></A>
<PRE>integer, intent(in) :: ibbnd
</PRE>
 bottom boundary condition
<A NAME="var_ftop"><H3>ftop</H3></A>
<PRE>real (kind=f), intent(in) :: ftop
</PRE>
 flux at top boundary
<A NAME="var_fbot"><H3>fbot</H3></A>
<PRE>real (kind=f), intent(in) :: fbot
</PRE>
 flux at bottom boundary
<A NAME="var_cvert_tbnd"><H3>cvert_tbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_tbnd
</PRE>
 quantity at top boundary
<A NAME="var_cvert_bbnd"><H3>cvert_bbnd</H3></A>
<PRE>real (kind=f), intent(in) :: cvert_bbnd
</PRE>
 quantity at bottom boundary
<A NAME="var_vertadvu"><H3>vertadvu</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertadvu
</PRE>
 upward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_vertadvd"><H3>vertadvd</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertadvd
</PRE>
 downward vertical transport rate into level k from level k-1 [cm/s]
<A NAME="var_vertdifu"><H3>vertdifu</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertdifu
</PRE>
 upward vertical diffusion rate into level k from level k-1 [cm/s]
<A NAME="var_vertdifd"><H3>vertdifd</H3></A>
<PRE>real (kind=f), intent(in), dimension (NZP1) :: vertdifd
</PRE>
 downward vertical diffusion rate into level k from level k-1 [cm/s]
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_iz"><H3>iz</H3></A>
<PRE>integer :: iz
</PRE>
<A NAME="var_istep"><H3>istep</H3></A>
<PRE>integer :: istep
</PRE>
<A NAME="var_nstep_sed"><H3>nstep_sed</H3></A>
<PRE>integer :: nstep_sed
</PRE>
<A NAME="var_fvert"><H3>fvert</H3></A>
<PRE>real (kind=f), dimension (NZ) :: fvert
</PRE>
<A NAME="var_up"><H3>up</H3></A>
<PRE>real (kind=f), dimension (NZP1) :: up
</PRE>
<A NAME="var_dn"><H3>dn</H3></A>
<PRE>real (kind=f), dimension (NZP1) :: dn
</PRE>
<A NAME="var_cfl_max"><H3>cfl_max</H3></A>
<PRE>real (kind=f) :: cfl_max
</PRE>
<A NAME="var_fvert_1"><H3>fvert_1</H3></A>
<PRE>real (kind=f) :: fvert_1
</PRE>
<A NAME="var_fvert_nz"><H3>fvert_nz</H3></A>
<PRE>real (kind=f) :: fvert_nz
</PRE>
</HTML>
