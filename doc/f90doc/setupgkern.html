<HTML>
<HEAD>
   <TITLE> subroutine setupgkern (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine setupgkern </H1>
<PRE>subroutine setupgkern

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>
    use <A HREF="sulfate_utils.html">sulfate_utils</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="setupgkern.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="setupgkern.html#var_cstate">cstate</A>
    integer, intent(inout) :: <A HREF="setupgkern.html#var_rc">rc</A>
    integer :: <A HREF="setupgkern.html#var_igas">igas</A>
    integer :: <A HREF="setupgkern.html#var_ielem">ielem</A>
    integer :: <A HREF="setupgkern.html#var_k">k</A>
    integer :: <A HREF="setupgkern.html#var_igroup">igroup</A>
    integer :: <A HREF="setupgkern.html#var_i">i</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_gstick">gstick</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_cor">cor</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_phish">phish</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_esh1">esh1</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_a1">a1</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_br">br</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rknudn">rknudn</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rknudnt">rknudnt</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rlam">rlam</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rlamt">rlamt</A>
    real (kind=f), dimension (NZ, NGAS) :: <A HREF="setupgkern.html#var_rhoa_cgs">rhoa_cgs</A>
    real (kind=f), dimension (NZ, NGAS) :: <A HREF="setupgkern.html#var_freep">freep</A>
    real (kind=f), dimension (NZ, NGAS) :: <A HREF="setupgkern.html#var_freept">freept</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rlh">rlh</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_diffus1">diffus1</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_thcond1">thcond1</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_reyn_shape">reyn_shape</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_schn">schn</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_prnum">prnum</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_x1">x1</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_x2">x2</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_fv">fv</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_surf_tens">surf_tens</A>
    real (kind=f) :: <A HREF="setupgkern.html#var_rho_h2so4">rho_H2SO4</A>

end subroutine setupgkern
</PRE>
 This routine defines radius-dependent but time-independent parameters
 used to calculate condensational growth of particles.  Growth rates
 are calculated at bin boundaries: the parameters calculated here
 ( <gro>, <gro1>, <gro2>, and <akelvin> )
 are defined at lower bin boundaries through the growth rate expression
 (for one particle) used in growevapl.f:
<PRE> 
   dm = gro*pvap*( S + 1 - Ak*As - gro1*gro2*qrad )
   --   -------------------------------------------
   dt               1 + gro*gro1*pvap

  where

  S    = supersaturation
  Ak   = exp(akelvin/r)
  As   = exp(-sol_ions * solute_mass/solwtmol * gwtmol/condensate_mass)
  pvap = saturation vapor pressure [dyne cm**-2]
  qrad = radiative energy absorbed
 </PRE>
 This routine requires that vertical profiles of temperature <T>,
 and pressure <p> are defined.
<P>
 This routine also requires that particle Reynolds' numbers are
 defined (setupvfall.f must be called before this).
<P>
<STRONG>Author:</STRONG> Andy Ackerman
<P>
<STRONG>Version:</STRONG> Dec-1995

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_igas"><H3>igas</H3></A>
<PRE>integer :: igas
</PRE>
 gas index
<A NAME="var_ielem"><H3>ielem</H3></A>
<PRE>integer :: ielem
</PRE>
 element index
<A NAME="var_k"><H3>k</H3></A>
<PRE>integer :: k
</PRE>
 z index
<A NAME="var_igroup"><H3>igroup</H3></A>
<PRE>integer :: igroup
</PRE>
 group index
<A NAME="var_i"><H3>i</H3></A>
<PRE>integer :: i
</PRE>
<A NAME="var_gstick"><H3>gstick</H3></A>
<PRE>real (kind=f) :: gstick
</PRE>
<A NAME="var_cor"><H3>cor</H3></A>
<PRE>real (kind=f) :: cor
</PRE>
<A NAME="var_phish"><H3>phish</H3></A>
<PRE>real (kind=f) :: phish
</PRE>
<A NAME="var_esh1"><H3>esh1</H3></A>
<PRE>real (kind=f) :: esh1
</PRE>
<A NAME="var_a1"><H3>a1</H3></A>
<PRE>real (kind=f) :: a1
</PRE>
<A NAME="var_br"><H3>br</H3></A>
<PRE>real (kind=f) :: br
</PRE>
<A NAME="var_rknudn"><H3>rknudn</H3></A>
<PRE>real (kind=f) :: rknudn
</PRE>
<A NAME="var_rknudnt"><H3>rknudnt</H3></A>
<PRE>real (kind=f) :: rknudnt
</PRE>
<A NAME="var_rlam"><H3>rlam</H3></A>
<PRE>real (kind=f) :: rlam
</PRE>
<A NAME="var_rlamt"><H3>rlamt</H3></A>
<PRE>real (kind=f) :: rlamt
</PRE>
<A NAME="var_rhoa_cgs"><H3>rhoa_cgs</H3></A>
<PRE>real (kind=f), dimension (NZ, NGAS) :: rhoa_cgs
</PRE>
<A NAME="var_freep"><H3>freep</H3></A>
<PRE>real (kind=f), dimension (NZ, NGAS) :: freep
</PRE>
<A NAME="var_freept"><H3>freept</H3></A>
<PRE>real (kind=f), dimension (NZ, NGAS) :: freept
</PRE>
<A NAME="var_rlh"><H3>rlh</H3></A>
<PRE>real (kind=f) :: rlh
</PRE>
<A NAME="var_diffus1"><H3>diffus1</H3></A>
<PRE>real (kind=f) :: diffus1
</PRE>
<A NAME="var_thcond1"><H3>thcond1</H3></A>
<PRE>real (kind=f) :: thcond1
</PRE>
<A NAME="var_reyn_shape"><H3>reyn_shape</H3></A>
<PRE>real (kind=f) :: reyn_shape
</PRE>
<A NAME="var_schn"><H3>schn</H3></A>
<PRE>real (kind=f) :: schn
</PRE>
<A NAME="var_prnum"><H3>prnum</H3></A>
<PRE>real (kind=f) :: prnum
</PRE>
<A NAME="var_x1"><H3>x1</H3></A>
<PRE>real (kind=f) :: x1
</PRE>
<A NAME="var_x2"><H3>x2</H3></A>
<PRE>real (kind=f) :: x2
</PRE>
<A NAME="var_fv"><H3>fv</H3></A>
<PRE>real (kind=f) :: fv
</PRE>
<A NAME="var_surf_tens"><H3>surf_tens</H3></A>
<PRE>real (kind=f) :: surf_tens
</PRE>
<A NAME="var_rho_h2so4"><H3>rho_H2SO4</H3></A>
<PRE>real (kind=f) :: rho_H2SO4
</PRE>
</HTML>
