<HTML>
<HEAD>
   <TITLE> module planck (generated by f90doc) </TITLE>
</HEAD>
<H1> Module planck </H1>
<PRE>module planck

        ! Subroutines and functions
    public function <A HREF="planck.html#function_planckintensity">planckIntensity</A> (wvl, temp)
    public function <A HREF="planck.html#function_planckintensitywidger1976">planckIntensityWidger1976</A> (wvl, temp, miniter)
    public function <A HREF="planck.html#function_planckbandintensitywidger1976">planckBandIntensityWidger1976</A> (wvl, dwvl, temp, miniter)
    public function <A HREF="planck.html#function_planckbandintensity">planckBandIntensity</A> (wvl, dwvl, temp, iter)
    public function <A HREF="planck.html#function_planckbandintensityconley2011">planckBandIntensityConley2011</A> (wvl, dwvl, temp, iter)

end module planck
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_planckintensity"><H3>planckIntensity</H3></A>
<PRE>public function planckIntensity (wvl, temp)
    real (kind=f), intent(in) :: wvl
</PRE>
<DL><DD><DL><DD>
 wavelength (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: temp
</PRE>
<DL><DD><DL><DD>
 temperature (K)
</DL></DL>
<PRE>    real (kind=f) :: planckIntensity
</PRE>
<DL><DD><DL><DD>
 Planck intensity (erg/s/cm2/sr/cm)
</DL></DL>
<PRE>end function planckIntensity
</PRE>
 This routine calculates the planck intensity.
<P>
 This algorithm is based upon eqn 1.2.4 from Liou[2002].
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Jan-2010
<A NAME="function_planckintensitywidger1976"><H3>planckIntensityWidger1976</H3></A>
<PRE>public function planckIntensityWidger1976 (wvl, temp, miniter)
    real (kind=f), intent(in) :: wvl
</PRE>
<DL><DD><DL><DD>
 band center wavelength (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: temp
</PRE>
<DL><DD><DL><DD>
 temperature (K)
</DL></DL>
<PRE>    integer, intent(in) :: miniter
</PRE>
<DL><DD><DL><DD>
 minimum iterations
</DL></DL>
<PRE>    real (kind=f) :: planckIntensityWidger1976
</PRE>
<DL><DD><DL><DD>
 Planck intensity (erg/s/cm2/sr/cm)
</DL></DL>
<PRE>end function planckIntensityWidger1976
</PRE>
 This routine calculates the total planck intensity from the specified
 wavelength to a wavelength of 0.
<P>
 This algorithm is based upon Widger and Woodall, BAMS, 1976 as
 indicated at http://www.spectralcalc.com/blackbody/appendixA.html.
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Aug-2011
<A NAME="function_planckbandintensitywidger1976"><H3>planckBandIntensityWidger1976</H3></A>
<PRE>public function planckBandIntensityWidger1976 (wvl, dwvl, temp, miniter)
    real (kind=f), intent(in) :: wvl
</PRE>
<DL><DD><DL><DD>
 band center wavelength (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: dwvl
</PRE>
<DL><DD><DL><DD>
 band width (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: temp
</PRE>
<DL><DD><DL><DD>
 temperature (K)
</DL></DL>
<PRE>    integer, intent(in) :: miniter
</PRE>
<DL><DD><DL><DD>
 minimum iterations
</DL></DL>
<PRE>    real (kind=f) :: planckBandIntensityWidger1976
</PRE>
<DL><DD><DL><DD>
 Planck intensity (erg/s/cm2/sr/cm)
</DL></DL>
<PRE>end function planckBandIntensityWidger1976
</PRE>
 This routine calculates the average planck intensity in the wavelength
 band defined by wvl and dwvl.
<P>
 This algorithm is based upon Widger and Woodall, BAMS, 1976 as
 indicated at http://www.spectralcalc.com/blackbody/appendixA.html.
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Aug-2011
<A NAME="function_planckbandintensity"><H3>planckBandIntensity</H3></A>
<PRE>public function planckBandIntensity (wvl, dwvl, temp, iter)
    real (kind=f), intent(in) :: wvl
</PRE>
<DL><DD><DL><DD>
 band center wavelength (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: dwvl
</PRE>
<DL><DD><DL><DD>
 band width (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: temp
</PRE>
<DL><DD><DL><DD>
 temperature (K)
</DL></DL>
<PRE>    integer, intent(in) :: iter
</PRE>
<DL><DD><DL><DD>
 number of iterations
</DL></DL>
<PRE>    real (kind=f) :: planckBandIntensity
</PRE>
<DL><DD><DL><DD>
 Planck intensity (erg/s/cm2/sr/cm)
</DL></DL>
<PRE>end function planckBandIntensity
</PRE>
 This routine calculates the average planck intensity in the wavelength
 band defined by wvl and dwvl.
<P>
 This algorithm does a brute force integral by dividing the band into
 small sub-bands. This routine can be slow.
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Aug-2011
<A NAME="function_planckbandintensityconley2011"><H3>planckBandIntensityConley2011</H3></A>
<PRE>public function planckBandIntensityConley2011 (wvl, dwvl, temp, iter)
    real (kind=f), intent(in) :: wvl
</PRE>
<DL><DD><DL><DD>
 band center wavelength (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: dwvl
</PRE>
<DL><DD><DL><DD>
 band width (cm)
</DL></DL>
<PRE>    real (kind=f), intent(in) :: temp
</PRE>
<DL><DD><DL><DD>
 temperature (K)
</DL></DL>
<PRE>    integer, intent(in) :: iter
</PRE>
<DL><DD><DL><DD>
 number of iterations
</DL></DL>
<PRE>    real (kind=f) :: planckBandIntensityConley2011
</PRE>
<DL><DD><DL><DD>
 Planck intensity (erg/s/cm2/sr/cm)
</DL></DL>
<PRE>end function planckBandIntensityConley2011
</PRE>
 This routine calculates the average planck intensity in the wavelength
 band defined by wvl and dwvl.
<P>
 error computed on full spectrum compared to planck function.  Band-levels may be different
 8.9%   error with   5 quadrature points in [100 micrometer, 1 millimeter]
 1.7%   error with  10 quadrature points in [100 micrometer, 1 millimeter]
 0.001% error with 100 quadrature points in [100 micrometer, 1 millimeter]
<P>
 NOTE: This code was design to work with the CAM RRTMG band structure, it may not work as
 well with arbitrary bands.
<P>
 NOTE: For most RRTMG bands, 3 quadrature points are probably sufficient, but testing is
 left to the reader.
<P>
<STRONG>Author:</STRONG> Andrew Conley, Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Aug-2011
</HTML>
