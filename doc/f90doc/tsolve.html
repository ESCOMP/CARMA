<HTML>
<HEAD>
   <TITLE> subroutine tsolve (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine tsolve </H1>
<PRE>subroutine tsolve

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="tsolve.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="tsolve.html#var_cstate">cstate</A>
    integer, intent(in) :: <A HREF="tsolve.html#var_iz">iz</A>
    real (kind=f) :: <A HREF="tsolve.html#var_scale_threshold">scale_threshold</A>
    integer, intent(inout) :: <A HREF="tsolve.html#var_rc">rc</A>
    real (kind=f) :: <A HREF="tsolve.html#var_dt">dt</A>
    real (kind=f) :: <A HREF="tsolve.html#var_threshold">threshold</A>

end subroutine tsolve
</PRE>
 This routine calculates new potential temperature concentration
 (and updates temperature) due to microphysical and radiative forcings.
 The equation solved (the first law of thermodynamics in flux form) is
<P>
   d(rhostar theta)     rhostar theta       d(qv)    1  dF
   <UL>
   <LI> --------------  = - ------------- * ( L ----- + --- -- )
         dt                 Cp T              dt    rho dz
<P>
   </UL>
 where
   rhostar = scaled air density
   theta   = potential temperature
   t       = time
   Cp      = specific heat (at constant pressure) of air
   T       = air temperature
   qv      = water vapor mixing ratio
   L       = latent heat
   F       = net radiative flux
   z       = unscaled altitude
<P>
<STRONG>Author:</STRONG> Andy Ackerman
<P>
<STRONG>Version:</STRONG> Oct-1997

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_iz"><H3>iz</H3></A>
<PRE>integer, intent(in) :: iz
</PRE>
 z index
<A NAME="var_scale_threshold"><H3>scale_threshold</H3></A>
<PRE>real (kind=f) :: scale_threshold
</PRE>
 Scaling factor for convergence thresholds
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_dt"><H3>dt</H3></A>
<PRE>real (kind=f) :: dt
</PRE>
<A NAME="var_threshold"><H3>threshold</H3></A>
<PRE>real (kind=f) :: threshold
</PRE>
</HTML>
