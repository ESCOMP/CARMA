<HTML>
<HEAD>
   <TITLE> subroutine pheat (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine pheat </H1>
<PRE>subroutine pheat

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carmastate_mod.html">carmastate_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>
    use <A HREF="planck.html">planck</A>, only         : planckIntensity, planckBandIntensity, planckBandIntensityWidger1976, planckBandIntensityConley2011

        ! Variables
    type (carma_type), intent(in) :: <A HREF="pheat.html#var_carma">carma</A>
    type (carmastate_type), intent(inout) :: <A HREF="pheat.html#var_cstate">cstate</A>
    integer, intent(in) :: <A HREF="pheat.html#var_iz">iz</A>
    integer, intent(in) :: <A HREF="pheat.html#var_igroup">igroup</A>
    integer, intent(in) :: <A HREF="pheat.html#var_iepart">iepart</A>
    integer, intent(in) :: <A HREF="pheat.html#var_ibin">ibin</A>
    integer, intent(in) :: <A HREF="pheat.html#var_igas">igas</A>
    real (kind=f), intent(out) :: <A HREF="pheat.html#var_dmdt">dmdt</A>
    integer, intent(inout) :: <A HREF="pheat.html#var_rc">rc</A>
    integer, parameter :: <A HREF="pheat.html#var_max_iter">MAX_ITER</A> = 10
    real (kind=f), parameter :: <A HREF="pheat.html#var_ddtp_limit">DDTP_LIMIT</A> = 0.01_f
    integer :: <A HREF="pheat.html#var_iter">iter</A>
    integer :: <A HREF="pheat.html#var_iwvl">iwvl</A>
    integer, dimension (NELEM) :: <A HREF="pheat.html#var_ieother">ieother</A>
    integer :: <A HREF="pheat.html#var_nother">nother</A>
    integer :: <A HREF="pheat.html#var_ieoth_rel">ieoth_rel</A>
    integer :: <A HREF="pheat.html#var_ieoth_abs">ieoth_abs</A>
    integer :: <A HREF="pheat.html#var_jother">jother</A>
    integer :: <A HREF="pheat.html#var_isol">isol</A>
    real (kind=f), dimension (NELEM) :: <A HREF="pheat.html#var_otherm">otherm</A>
    real (kind=f) :: <A HREF="pheat.html#var_argsol">argsol</A>
    real (kind=f) :: <A HREF="pheat.html#var_othermtot">othermtot</A>
    real (kind=f) :: <A HREF="pheat.html#var_othervtot">othervtot</A>
    real (kind=f) :: <A HREF="pheat.html#var_condm">condm</A>
    real (kind=f) :: <A HREF="pheat.html#var_condv">condv</A>
    real (kind=f) :: <A HREF="pheat.html#var_volfrc">volfrc</A>
    real (kind=f) :: <A HREF="pheat.html#var_akas">akas</A>
    real (kind=f) :: <A HREF="pheat.html#var_expon">expon</A>
    real (kind=f) :: <A HREF="pheat.html#var_g0">g0</A>
    real (kind=f) :: <A HREF="pheat.html#var_g1">g1</A>
    real (kind=f) :: <A HREF="pheat.html#var_g2">g2</A>
    real (kind=f) :: <A HREF="pheat.html#var_ss">ss</A>
    real (kind=f) :: <A HREF="pheat.html#var_pvap">pvap</A>
    real (kind=f) :: <A HREF="pheat.html#var_qrad">qrad</A>
    real (kind=f) :: <A HREF="pheat.html#var_rlh">rlh</A>
    real (kind=f) :: <A HREF="pheat.html#var_tp">tp</A>
    real (kind=f) :: <A HREF="pheat.html#var_dtp">dtp</A>
    real (kind=f) :: <A HREF="pheat.html#var_dtpl">dtpl</A>
    real (kind=f) :: <A HREF="pheat.html#var_ddtp">ddtp</A>
    real (kind=f) :: <A HREF="pheat.html#var_plkint">plkint</A>

end subroutine pheat
</PRE>
 This routine evaluate particle loss rates due to particle heating.
<P>
 The net energy absorbed by each particle is calculatated as <qrad>, and
 this heating rate is included in the caclulation of <dmdt> in growevapl. The
 particle temperature perturbation realtive to atmospheric temperature <dtpart>
 and the radiative heating of the atmosphere by particles <partheat>
 are also calculated.
<P>
 This algorithm is based upon the model described in the appendix of
   Toon et al., J. Geophys. Res., 94, 11359-11380, 1989.
<P>
 This routine assumes that the following variable/tables have already been
 set up:
<P>
   <radint> intensity of incoming radiance (solar+ir) [erg/cm2/sr/s/cm]
   <wave>   wavelengths used for integration [cm]
   <dwave>  width of wavelength bands for integration [cm]
   <do_wave_emit> whether planck emission should be doen for the band
   <qext>   extinction [cm2]
   <ssa>    single scattering albedo
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> Jan-2010

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_cstate"><H3>cstate</H3></A>
<PRE>type (carmastate_type), intent(inout) :: cstate
</PRE>
 the carma state object
<A NAME="var_iz"><H3>iz</H3></A>
<PRE>integer, intent(in) :: iz
</PRE>
 vertical index
<A NAME="var_igroup"><H3>igroup</H3></A>
<PRE>integer, intent(in) :: igroup
</PRE>
 group index
<A NAME="var_iepart"><H3>iepart</H3></A>
<PRE>integer, intent(in) :: iepart
</PRE>
 group's concentration element index
<A NAME="var_ibin"><H3>ibin</H3></A>
<PRE>integer, intent(in) :: ibin
</PRE>
 bin index
<A NAME="var_igas"><H3>igas</H3></A>
<PRE>integer, intent(in) :: igas
</PRE>
 gas index
<A NAME="var_dmdt"><H3>dmdt</H3></A>
<PRE>real (kind=f), intent(out) :: dmdt
</PRE>
 particle growth rate (g/s)
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_max_iter"><H3>MAX_ITER</H3></A>
<PRE>integer, parameter :: MAX_ITER = 10
</PRE>
<A NAME="var_ddtp_limit"><H3>DDTP_LIMIT</H3></A>
<PRE>real (kind=f), parameter :: DDTP_LIMIT = 0.01_f
</PRE>
<A NAME="var_iter"><H3>iter</H3></A>
<PRE>integer :: iter
</PRE>
<A NAME="var_iwvl"><H3>iwvl</H3></A>
<PRE>integer :: iwvl
</PRE>
<A NAME="var_ieother"><H3>ieother</H3></A>
<PRE>integer, dimension (NELEM) :: ieother
</PRE>
<A NAME="var_nother"><H3>nother</H3></A>
<PRE>integer :: nother
</PRE>
<A NAME="var_ieoth_rel"><H3>ieoth_rel</H3></A>
<PRE>integer :: ieoth_rel
</PRE>
<A NAME="var_ieoth_abs"><H3>ieoth_abs</H3></A>
<PRE>integer :: ieoth_abs
</PRE>
<A NAME="var_jother"><H3>jother</H3></A>
<PRE>integer :: jother
</PRE>
<A NAME="var_isol"><H3>isol</H3></A>
<PRE>integer :: isol
</PRE>
<A NAME="var_otherm"><H3>otherm</H3></A>
<PRE>real (kind=f), dimension (NELEM) :: otherm
</PRE>
<A NAME="var_argsol"><H3>argsol</H3></A>
<PRE>real (kind=f) :: argsol
</PRE>
<A NAME="var_othermtot"><H3>othermtot</H3></A>
<PRE>real (kind=f) :: othermtot
</PRE>
<A NAME="var_othervtot"><H3>othervtot</H3></A>
<PRE>real (kind=f) :: othervtot
</PRE>
<A NAME="var_condm"><H3>condm</H3></A>
<PRE>real (kind=f) :: condm
</PRE>
<A NAME="var_condv"><H3>condv</H3></A>
<PRE>real (kind=f) :: condv
</PRE>
<A NAME="var_volfrc"><H3>volfrc</H3></A>
<PRE>real (kind=f) :: volfrc
</PRE>
<A NAME="var_akas"><H3>akas</H3></A>
<PRE>real (kind=f) :: akas
</PRE>
<A NAME="var_expon"><H3>expon</H3></A>
<PRE>real (kind=f) :: expon
</PRE>
<A NAME="var_g0"><H3>g0</H3></A>
<PRE>real (kind=f) :: g0
</PRE>
<A NAME="var_g1"><H3>g1</H3></A>
<PRE>real (kind=f) :: g1
</PRE>
<A NAME="var_g2"><H3>g2</H3></A>
<PRE>real (kind=f) :: g2
</PRE>
<A NAME="var_ss"><H3>ss</H3></A>
<PRE>real (kind=f) :: ss
</PRE>
<A NAME="var_pvap"><H3>pvap</H3></A>
<PRE>real (kind=f) :: pvap
</PRE>
<A NAME="var_qrad"><H3>qrad</H3></A>
<PRE>real (kind=f) :: qrad
</PRE>
<A NAME="var_rlh"><H3>rlh</H3></A>
<PRE>real (kind=f) :: rlh
</PRE>
<A NAME="var_tp"><H3>tp</H3></A>
<PRE>real (kind=f) :: tp
</PRE>
<A NAME="var_dtp"><H3>dtp</H3></A>
<PRE>real (kind=f) :: dtp
</PRE>
<A NAME="var_dtpl"><H3>dtpl</H3></A>
<PRE>real (kind=f) :: dtpl
</PRE>
<A NAME="var_ddtp"><H3>ddtp</H3></A>
<PRE>real (kind=f) :: ddtp
</PRE>
<A NAME="var_plkint"><H3>plkint</H3></A>
<PRE>real (kind=f) :: plkint
</PRE>
</HTML>
