<HTML>
<HEAD>
   <TITLE> subroutine mie (generated by f90doc) </TITLE>
</HEAD>
<H1> Subroutine mie </H1>
<PRE>subroutine mie

        ! Uses
    use <A HREF="carma_precision_mod.html">carma_precision_mod</A>
    use <A HREF="carma_enums_mod.html">carma_enums_mod</A>
    use <A HREF="carma_constants_mod.html">carma_constants_mod</A>
    use <A HREF="carma_types_mod.html">carma_types_mod</A>
    use <A HREF="carma_mod.html">carma_mod</A>
    use <A HREF="fractal_meanfield_mod.html">fractal_meanfield_mod</A>

        ! Calls
    call <A HREF="bhmie.html">bhmie</A>
    call <A HREF="fractal_meanfield.html">fractal_meanfield</A>
    call <A HREF="miess.html">miess</A>

        ! Variables
    type (carma_type), intent(in) :: <A HREF="mie.html#var_carma">carma</A>
    integer, intent(in) :: <A HREF="mie.html#var_miertn">miertn</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_radius">radius</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_wavelength">wavelength</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_nmonomer">nmonomer</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_fractaldim">fractaldim</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_rmonomer">rmonomer</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_falpha_in">falpha_in</A>
    complex (kind=f), intent(in) :: <A HREF="mie.html#var_m">m</A>
    real (kind=f), intent(in) :: <A HREF="mie.html#var_rcore">rcore</A>
    complex (kind=f), intent(in) :: <A HREF="mie.html#var_mcore">mcore</A>
    real (kind=f), intent(out) :: <A HREF="mie.html#var_lqext">lqext</A>
    real (kind=f), intent(out) :: <A HREF="mie.html#var_lqsca">lqsca</A>
    real (kind=f), intent(out) :: <A HREF="mie.html#var_lasym">lasym</A>
    integer, intent(inout) :: <A HREF="mie.html#var_rc">rc</A>
    integer, parameter :: <A HREF="mie.html#var_nang">nang</A> = 10
    real (kind=f), dimension (IT) :: <A HREF="mie.html#var_theta">theta</A>
    real (kind=f) :: <A HREF="mie.html#var_wvno">wvno</A>
    real (kind=f) :: <A HREF="mie.html#var_rfr">rfr</A>
    real (kind=f) :: <A HREF="mie.html#var_rfi">rfi</A>
    real (kind=f) :: <A HREF="mie.html#var_rfcr">rfcr</A>
    real (kind=f) :: <A HREF="mie.html#var_rfci">rfci</A>
    real (kind=f) :: <A HREF="mie.html#var_x">x</A>
    real (kind=f) :: <A HREF="mie.html#var_qback">qback</A>
    real (kind=f) :: <A HREF="mie.html#var_ctbrqs">ctbrqs</A>
    complex (kind=f), dimension (2*nang-1) :: <A HREF="mie.html#var_s1">s1</A>
    complex (kind=f), dimension (2*nang-1) :: <A HREF="mie.html#var_s2">s2</A>
    real (kind=f) :: <A HREF="mie.html#var_rmonomer_out">rmonomer_out</A>
    real (kind=f) :: <A HREF="mie.html#var_fractaldim_out">fractaldim_out</A>

end subroutine mie
</PRE>
 There are several different algorithms that can be used to solve
 a mie calculation for the optical properties of particles. This
 routine provides a generic front end to these different mie
 routines.
<P>
 Current methods are:
  miess - Original CARMA code, from Toon and Ackerman, supports core/shell
  bhmie - Homogeneous sphere, from Bohren and Huffman, handles wider range of parameters
<P>
<STRONG>Author:</STRONG> Chuck Bardeen
<P>
<STRONG>Version:</STRONG> 2011

<HR><H2> Description of Variables </H2>
<A NAME="var_carma"><H3>carma</H3></A>
<PRE>type (carma_type), intent(in) :: carma
</PRE>
 the carma object
<A NAME="var_miertn"><H3>miertn</H3></A>
<PRE>integer, intent(in) :: miertn
</PRE>
 mie routine enumeration
<A NAME="var_radius"><H3>radius</H3></A>
<PRE>real (kind=f), intent(in) :: radius
</PRE>
 radius (cm)
<A NAME="var_wavelength"><H3>wavelength</H3></A>
<PRE>real (kind=f), intent(in) :: wavelength
</PRE>
 wavelength (cm)
<A NAME="var_nmonomer"><H3>nmonomer</H3></A>
<PRE>real (kind=f), intent(in) :: nmonomer
</PRE>
 number of monomers per aggregate [fractal particles only]
<A NAME="var_fractaldim"><H3>fractaldim</H3></A>
<PRE>real (kind=f), intent(in) :: fractaldim
</PRE>
 fractal dimension [fractal particles only]
<A NAME="var_rmonomer"><H3>rmonomer</H3></A>
<PRE>real (kind=f), intent(in) :: rmonomer
</PRE>
 monomer size (units?) [fractal particles only]
<A NAME="var_falpha_in"><H3>falpha_in</H3></A>
<PRE>real (kind=f), intent(in) :: falpha_in
</PRE>
 packing coefficient [fractal particles only]
<A NAME="var_m"><H3>m</H3></A>
<PRE>complex (kind=f), intent(in) :: m
</PRE>
 refractive index particle
<A NAME="var_rcore"><H3>rcore</H3></A>
<PRE>real (kind=f), intent(in) :: rcore
</PRE>
 radius core (cm) [core shell only]
<A NAME="var_mcore"><H3>mcore</H3></A>
<PRE>complex (kind=f), intent(in) :: mcore
</PRE>
 refractive index core [core shell only]
<A NAME="var_lqext"><H3>lqext</H3></A>
<PRE>real (kind=f), intent(out) :: lqext
</PRE>
 EFFICIENCY FACTOR FOR EXTINCTION
<A NAME="var_lqsca"><H3>lqsca</H3></A>
<PRE>real (kind=f), intent(out) :: lqsca
</PRE>
 EFFICIENCY FACTOR FOR SCATTERING
<A NAME="var_lasym"><H3>lasym</H3></A>
<PRE>real (kind=f), intent(out) :: lasym
</PRE>
 asymmetry factor
<A NAME="var_rc"><H3>rc</H3></A>
<PRE>integer, intent(inout) :: rc
</PRE>
 return code, negative indicates failure
<A NAME="var_nang"><H3>nang</H3></A>
<PRE>integer, parameter :: nang = 10
</PRE>
<A NAME="var_theta"><H3>theta</H3></A>
<PRE>real (kind=f), dimension (IT) :: theta
</PRE>
<A NAME="var_wvno"><H3>wvno</H3></A>
<PRE>real (kind=f) :: wvno
</PRE>
<A NAME="var_rfr"><H3>rfr</H3></A>
<PRE>real (kind=f) :: rfr
</PRE>
<A NAME="var_rfi"><H3>rfi</H3></A>
<PRE>real (kind=f) :: rfi
</PRE>
<A NAME="var_rfcr"><H3>rfcr</H3></A>
<PRE>real (kind=f) :: rfcr
</PRE>
<A NAME="var_rfci"><H3>rfci</H3></A>
<PRE>real (kind=f) :: rfci
</PRE>
<A NAME="var_x"><H3>x</H3></A>
<PRE>real (kind=f) :: x
</PRE>
<A NAME="var_qback"><H3>qback</H3></A>
<PRE>real (kind=f) :: qback
</PRE>
<A NAME="var_ctbrqs"><H3>ctbrqs</H3></A>
<PRE>real (kind=f) :: ctbrqs
</PRE>
<A NAME="var_s1"><H3>s1</H3></A>
<PRE>complex (kind=f), dimension (2*nang-1) :: s1
</PRE>
<A NAME="var_s2"><H3>s2</H3></A>
<PRE>complex (kind=f), dimension (2*nang-1) :: s2
</PRE>
<A NAME="var_rmonomer_out"><H3>rmonomer_out</H3></A>
<PRE>real (kind=f) :: rmonomer_out
</PRE>
<A NAME="var_fractaldim_out"><H3>fractaldim_out</H3></A>
<PRE>real (kind=f) :: fractaldim_out
</PRE>
</HTML>
